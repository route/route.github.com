<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="/images/favicon.ico">
    <meta name="yandex-verification" content="3bfdb691bc608cfc" />
    <meta name="description" content="Log which line caused a query">
    <title>Query Trail</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link href="/stylesheets/application.css" rel="stylesheet" /><link href="/stylesheets/highlighting.css" rel="stylesheet" />
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col">
          <header>
            <a href="/">NopeCode</a>
          </header>
            <article>
    <h2>Query Trail</h2>
    <div class="tags">
        <a href="/tags/ruby.html">ruby</a>
        <a href="/tags/rails.html">rails</a>
        <a href="/tags/sql.html">sql</a>
    </div>
    <time datetime="2014-08-10">August 10, 2014</time>
    <p>Recently I switched on a project with lots of legacy code. It was on Rails 2,
Rails 3 and now I&rsquo;ve updated it to Rails 4.1. You can&rsquo;t even imagine how much
rubbish I got rid of. But the thing I&rsquo;d like to share with you today is
<a href="https://github.com/route/query_trail">QueryTrail</a>. This simple but useful gem
shows you the backtrace of fired queries. You have to agree that when just one
action of your controller sends hundreds sql requests from helpers, templates
and so forth, it&rsquo;s definitely hard to locate the place for specific query. But
not for now:</p>
<div class="highlight"><pre class="highlight plaintext"><code>User Load (0.4ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1
Query Trail: config/initializers/warden.rb:11:in `block in &lt;top (required)&gt;'
             config/initializers/warden.rb:15:in `block in &lt;top (required)&gt;'
Doc Load (18.2ms)  SELECT `docs`.* FROM `docs`  WHERE `docs`.`approved` = 1
Query Trail: app/views/main/_docs.html.erb:2
             app/helpers/docs_helper.rb:3:in `render_main_block'
             app/views/main/index.html.erb:13
             app/views/main/index.html.erb:9
</code></pre></div>
  </article>
          <footer>
            <a href="/about.html">Dmitry Vorotilin</a>
            |
            Copyright © 2012-2021
          </footer>
          <div class="yandex_metrika">
  <!-- Yandex.Metrika informer -->
  <a href="https://metrika.yandex.ru/stat/?id=25785359&amp;from=informer"
  target="_blank" rel="nofollow"><img src="https://informer.yandex.ru/informer/25785359/1_0_FFFFFFFF_EFEFEFFF_0_pageviews"
  style="width:80px; height:15px; border:0;" alt="Яндекс.Метрика" title="Яндекс.Метрика: данные за сегодня (просмотры)" /></a>
  <!-- /Yandex.Metrika informer -->

  <!-- Yandex.Metrika counter -->
  <script type="text/javascript" >
      (function (d, w, c) {
          (w[c] = w[c] || []).push(function() {
              try {
                  w.yaCounter25785359 = new Ya.Metrika({
                      id:25785359,
                      clickmap:true,
                      trackLinks:true,
                      accurateTrackBounce:true,
                      webvisor:true
                  });
              } catch(e) { }
          });

          var n = d.getElementsByTagName("script")[0],
              s = d.createElement("script"),
              f = function () { n.parentNode.insertBefore(s, n); };
          s.type = "text/javascript";
          s.async = true;
          s.src = "https://mc.yandex.ru/metrika/watch.js";

          if (w.opera == "[object Opera]") {
              d.addEventListener("DOMContentLoaded", f, false);
          } else { f(); }
      })(document, window, "yandex_metrika_callbacks");
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/25785359" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->
</div>

        </div>
      </div>
    </div>
  </body>
</html>
