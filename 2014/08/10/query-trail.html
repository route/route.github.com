<!DOCTYPE html>
<html>
  <head>
    <title>Query Trail</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="author" content="Dmitry Vorotilin">

    <link href="/stylesheets/application.css" rel="stylesheet" />
    <script src="/javascripts/application.js"></script>
  </head>
  <body>
    <div class="content">
      <header>
        <a href="/">Blog</a>
      </header>
        <article>
    <h1>Query Trail</h1>
    <time>August 10, 2014</time>
    <p>Recently I switched on a project with lots of legacy code. It was on Rails 2,
Rails 3 and now I&rsquo;ve updated it to Rails 4.1. You can&rsquo;t even imagine how much
rubbish I got rid of. But the thing I&rsquo;d like to share with you today is
<a href="https://github.com/route/query_trail">QueryTrail</a>. This simple but useful gem
shows you the backtrace of fired queries. You have to agree that when just one
action of your controller sends hundreds sql requests from helpers, templates
and so forth, it&rsquo;s definitely hard to locate the place for specific query. But
not for now:</p>
<div class="highlight"><pre class="highlight plaintext"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>User Load (0.4ms)  SELECT  `users`.* FROM `users`  WHERE `users`.`id` = 1 LIMIT 1
Query Trail: config/initializers/warden.rb:11:in `block in &lt;top (required)&gt;'
             config/initializers/warden.rb:15:in `block in &lt;top (required)&gt;'
Doc Load (18.2ms)  SELECT `docs`.* FROM `docs`  WHERE `docs`.`approved` = 1
Query Trail: app/views/main/_docs.html.erb:2
             app/helpers/docs_helper.rb:3:in `render_main_block'
             app/views/main/index.html.erb:13
             app/views/main/index.html.erb:9
</pre></td></tr></tbody></table></code></pre></div>
    <div class="share">
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="rO_Oute">Tweet</a>
      <script type="text/javascript">
        //<![CDATA[
          !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
        //]]>
      </script>
    </div>
  </article>
      <footer>
        Copyright © 2012-2018
        <a href="https://github.com/route" target="_blank">Dmitry Vorotilin</a>
        |
        <a href="/cv.html" target="_blank">CV</a>
      </footer>
      <div class="yandex_metrika">
        <!-- Yandex.Metrika informer -->
<a href="https://metrika.yandex.ru/stat/?id=25785359&amp;from=informer"
target="_blank" rel="nofollow"><img src="//bs.yandex.ru/informer/25785359/1_0_FFFFFFFF_EFEFEFFF_0_pageviews"
style="width:80px; height:15px; border:0;" alt="Яндекс.Метрика" title="Яндекс.Метрика: данные за сегодня (просмотры)" /></a>
<!-- /Yandex.Metrika informer -->

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter25785359 = new Ya.Metrika({id:25785359,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/25785359" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

      </div>
    </div>
  </body>
</html>
